{"ast":null,"code":"import _defineProperty from\"C:/Users/Siva/Desktop/react/EcommerceMERN/ecommerce/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/Siva/Desktop/react/EcommerceMERN/ecommerce/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/Siva/Desktop/react/EcommerceMERN/ecommerce/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Siva/Desktop/react/EcommerceMERN/ecommerce/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Siva/Desktop/react/EcommerceMERN/ecommerce/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{createContext,useEffect,useState}from'react';import{getProducts}from'../products';import{jsx as _jsx}from\"react/jsx-runtime\";export var ShopContext=/*#__PURE__*/createContext(null);export var ShopContextProvider=function ShopContextProvider(props){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),cartItems=_useState2[0],setCartItems=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),products=_useState4[0],setProducts=_useState4[1];useEffect(function(){function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var productsArray;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getProducts();case 3:productsArray=_context.sent;// Use await to fetch products\nsetProducts(productsArray);setCartItems(getDefaultCart(productsArray));_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.error('Error fetching products:',_context.t0);case 11:case\"end\":return _context.stop();}},_callee,null,[[0,8]]);}));return _fetchData.apply(this,arguments);}fetchData();},[]);var getDefaultCart=function getDefaultCart(products){var cart={};for(var i=1;i<products.length+1;i++){cart[i]=0;}return cart;};var getTotalCartAmount=function getTotalCartAmount(){var totalAmount=0;var _loop=function _loop(item){if(cartItems[item]>0){var itemInfo=products.find(function(product){return product.id===Number(item);});totalAmount+=cartItems[item]*itemInfo.price;}};for(var item in cartItems){_loop(item);}return totalAmount;};var addToCart=function addToCart(itemId){setCartItems(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},itemId,prev[itemId]+1));});};var removeFromCart=function removeFromCart(itemId){setCartItems(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},itemId,prev[itemId]-1));});};var updateCartItemCount=function updateCartItemCount(newAmount,itemId){setCartItems(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},itemId,newAmount));});};var contextValues={cartItems:cartItems,addToCart:addToCart,removeFromCart:removeFromCart,updateCartItemCount:updateCartItemCount,getTotalCartAmount:getTotalCartAmount};return/*#__PURE__*/_jsx(ShopContext.Provider,{value:contextValues,children:props.children});};","map":{"version":3,"names":["React","createContext","useEffect","useState","getProducts","jsx","_jsx","ShopContext","ShopContextProvider","props","_useState","_useState2","_slicedToArray","cartItems","setCartItems","_useState3","_useState4","products","setProducts","fetchData","_fetchData","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","productsArray","wrap","_callee$","_context","prev","next","sent","getDefaultCart","t0","console","error","stop","cart","i","length","getTotalCartAmount","totalAmount","_loop","item","itemInfo","find","product","id","Number","price","addToCart","itemId","_objectSpread","_defineProperty","removeFromCart","updateCartItemCount","newAmount","contextValues","Provider","value","children"],"sources":["C:/Users/Siva/Desktop/react/EcommerceMERN/ecommerce/src/context/shop-context.jsx"],"sourcesContent":["import React, { createContext, useEffect, useState } from 'react';\r\nimport {getProducts} from '../products';\r\n\r\nexport const ShopContext=createContext(null);\r\n\r\nexport const ShopContextProvider = (props) => {\r\n    const [cartItems,setCartItems]=useState({});\r\n    const [products,setProducts]=useState([]);\r\n\r\n    useEffect(()=>{\r\n        async function fetchData() {\r\n            try {\r\n                const productsArray = await getProducts(); // Use await to fetch products\r\n                setProducts(productsArray);\r\n                setCartItems(getDefaultCart(productsArray));\r\n            } catch (error) {\r\n                console.error('Error fetching products:', error);\r\n            }\r\n        }\r\n        fetchData();\r\n    },[]);\r\n\r\n    const getDefaultCart=(products)=>{\r\n        let cart={};\r\n        for(let i=1;i<products.length+1;i++){\r\n            cart[i]=0;\r\n        }\r\n        return cart;\r\n    }\r\n\r\n    const getTotalCartAmount=()=>{\r\n        let totalAmount=0;\r\n        for(const item in cartItems){\r\n            if(cartItems[item]>0){\r\n                let itemInfo=products.find((product)=>product.id===Number(item));\r\n                totalAmount+=cartItems[item]*itemInfo.price;\r\n            }\r\n        }\r\n        return totalAmount;\r\n    }\r\n\r\n    const addToCart=(itemId)=>{\r\n        setCartItems((prev)=>({...prev,[itemId]:prev[itemId]+1}));\r\n    }\r\n\r\n    const removeFromCart=(itemId)=>{\r\n        setCartItems((prev)=>({...prev,[itemId]:prev[itemId]-1}));\r\n    }\r\n\r\n    const updateCartItemCount=(newAmount,itemId)=>{\r\n        setCartItems((prev)=>({...prev,[itemId]:newAmount}));\r\n    }\r\n\r\n    const contextValues={cartItems,addToCart,removeFromCart,updateCartItemCount,getTotalCartAmount};\r\n\r\n  return (\r\n    <ShopContext.Provider value={contextValues}>{props.children}</ShopContext.Provider>\r\n  )\r\n}\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}